<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCAA Basketball Pool 2025-26 - Live ESPN Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        .trophy-gold { background: linear-gradient(135deg, #FFD700, #FFA500); }
        .trophy-silver { background: linear-gradient(135deg, #C0C0C0, #A8A8A8); }
        .trophy-bronze { background: linear-gradient(135deg, #CD7F32, #B8860B); }
        
        .rank-1 { border-left: 4px solid #FFD700; }
        .rank-2 { border-left: 4px solid #C0C0C0; }
        .rank-3 { border-left: 4px solid #CD7F32; }
        
        .team-logo {
            width: 32px;
            height: 32px;
            object-fit: contain;
            background: white;
            border-radius: 4px;
            padding: 2px;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .win-badge {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // NCAA Team name to ESPN ID mapping
        const teamLogoMap = {
            'Alabama': 333, 'Arizona': 12, 'Arkansas': 8, 'Auburn': 2, 'Baylor': 239,
            'Brigham Young': 252, 'BYU': 252, 'Connecticut': 41, 'UConn': 41, 
            'Duke': 150, 'Florida': 57, 'Gonzaga': 2250, 'Houston': 248,
            'Illinois': 356, 'Indiana': 84, 'Iowa': 2294, 'Iowa State': 66,
            'Kansas': 2305, 'Kentucky': 96, 'Louisiana State': 99, 'LSU': 99,
            'Louisville': 97, 'Maryland': 120, 'Memphis': 235, 'Michigan': 130,
            'Michigan State': 127, 'North Carolina': 153, 'UNC': 153, 
            'Ohio State': 194, 'Oregon': 2483, 'Purdue': 2509,
            'San Diego State': 21, 'SDSU': 21, 'Tennessee': 2633,
            'Texas Tech': 2641, 'UCLA': 26, 'Virginia': 258, 'Wisconsin': 275,
            'Clemson': 228, 'NC State': 152, 'Saint Louis': 139, 'Dayton': 2168,
            'Akron': 2006, 'Bowling Green': 189, 'Miami (FL)': 2390, 'Miami': 2390,
            'Saint Mary\'s (CA)': 2608, 'Marquette': 269, 'Creighton': 156,
            'St. John\'s (NY)': 2599, 'Georgetown': 46, 'Villanova': 222,
            'Xavier': 2752, 'Butler': 2086, 'Providence': 2507, 'Seton Hall': 2550,
            'Vanderbilt': 238, 'West Virginia': 277, 'USC': 30, 'Southern California': 30,
            'Montana': 149, 'Grand Canyon': 2253, 'Toledo': 2649, 'Wichita State': 2724,
            'South Florida': 58, 'USF': 58, 'SMU': 2567, 'Southern Methodist': 2567,
            'North Texas': 249, 'Belmont': 2057, 'VCU': 2670, 'Virginia Commonwealth': 2670,
            'George Washington': 45, 'George Mason': 2244, 'Hawaii': 62, 'Kennesaw State': 338,
            'Troy': 2653, 'Wright State': 2747, 'Youngstown State': 2755, 'Marshall': 276,
            'Murray State': 93, 'Miami (OH)': 193, 'Colorado State': 36, 'Boise State': 68,
            'UC San Diego': 2540, 'Iowa State': 66, 'Kansas': 2305
        };

        const getTeamLogo = (teamName) => {
            const espnId = teamLogoMap[teamName];
            if (espnId) {
                return `https://a.espncdn.com/i/teamlogos/ncaa/500/${espnId}.png`;
            }
            return `https://via.placeholder.com/32x32/667eea/ffffff?text=${teamName.charAt(0)}`;
        };

        // Normalize team names for matching
        const normalizeTeamName = (name) => {
            if (!name) return '';
            
            const mappings = {
                'Connecticut': 'UConn',
                'Brigham Young': 'BYU',
                'Southern California': 'USC',
                'Louisiana State': 'LSU',
                'Southern Methodist': 'SMU',
                'North Carolina State': 'NC State',
                'Saint Mary\'s College of California': 'Saint Mary\'s (CA)',
                'St. Mary\'s': 'Saint Mary\'s (CA)',
                'Miami (Florida)': 'Miami (FL)',
                'Miami (Ohio)': 'Miami (OH)',
            };
            
            let normalized = name.trim();
            
            for (const [key, value] of Object.entries(mappings)) {
                if (normalized.toLowerCase().includes(key.toLowerCase())) {
                    return value;
                }
            }
            
            normalized = normalized.replace(/\s+State$/i, ' St.');
            normalized = normalized.replace(/\(.*?\)/g, '').trim();
            
            return normalized;
        };

        // Draft data - participants and their teams
        const DRAFT_DATA = {
            "Stan": ["Arkansas State", "Cleveland State", "Colgate", "Cornell", "Dayton", "Grand Canyon", "Louisville", "Memphis", "Merrimack", "Montana", "Northern Kentucky", "Purdue", "South Florida", "Toledo"],
            "Brian": ["Boise State", "Colorado State", "George Mason", "Houston", "Iowa", "Maryland", "North Texas", "Southern Methodist", "Tennessee", "UC San Diego", "North Carolina", "West Virginia", "Wichita State", "Miami (OH)"],
            "Andrew": ["California Baptist", "Bethune-Cookman", "Buffalo", "Georgia", "Northern Colorado", "South Alabama", "Towson", "Tarleton State", "Utah Valley", "Towson", "Alabama", "Jacksonville State", "Santa Clara", "St. Thomas"],
            "Matt": ["Auburn", "Bradley", "Lipscomb", "Marist", "Marquette", "Nevada", "New Mexico", "Oregon", "Oregon State", "Texas Tech", "Virginia Commonwealth", "Michigan State", "Arkansas", "Mississippi"],
            "Ryan": ["Bowling Green", "Cincinnati", "Idaho", "Loyola Marymount", "Miami (FL)", "Missouri", "Navy", "Northern Iowa", "Siena", "St. Bonaventure", "Connecticut", "Utah State", "Wisconsin", "Yale"],
            "Tom": ["Akron", "Clemson", "Duke", "East Tennessee State", "Iowa State", "Marshall", "Murray State", "Oklahoma State", "SIU Edwardsville", "Saint Louis", "Saint Mary's (CA)", "Vanderbilt", "Virginia Tech", "Youngstown State"],
            "Pete": ["Brigham Young", "Baylor", "Creighton", "Florida", "Illinois", "Kentucky", "Little Rock", "Maine", "Radford", "San Francisco", "Southern California", "St. John's (NY)", "UCLA", "Kansas"],
            "Neel": ["Boston University", "College of Charleston", "Florida Atlantic", "Illinois State", "James Madison", "Michigan", "Montana State", "Princeton", "Quinnipiac", "Sam Houston", "Samford", "Stephen F. Austin", "UC Santa Barbara", "Villanova"],
            "Kevin": ["Arizona", "Belmont", "George Washington", "Gonzaga", "Hawaii", "Indiana", "Kennesaw State", "Louisiana State", "NC State", "San Diego State", "Troy", "Virginia", "Alabama", "Wright State"],
            "Jake": ["Chattanooga", "Furman", "High Point", "Iona", "Kent State", "Liberty", "McNeese State", "Norfolk State", "Ohio", "South Dakota State", "Ohio State", "UC Irvine", "UNC Wilmington", "Winthrop"]
        };

        function PoolTracker() {
            const [teamRecords, setTeamRecords] = useState({});
            const [selectedParticipant, setSelectedParticipant] = useState(null);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [fetching, setFetching] = useState(false);
            const [fetchStatus, setFetchStatus] = useState('Click "Refresh from ESPN" to load latest data');
            const [autoRefresh, setAutoRefresh] = useState(false);

            useEffect(() => {
                // Load initial data on mount
                fetchESPNData();
            }, []);

            useEffect(() => {
                if (autoRefresh) {
                    const interval = setInterval(() => {
                        fetchESPNData();
                    }, 300000); // Every 5 minutes
                    return () => clearInterval(interval);
                }
            }, [autoRefresh]);

            const fetchESPNData = async () => {
                setFetching(true);
                setFetchStatus('üîÑ Fetching live data from ESPN...');
                
                try {
                    const response = await fetch('https://site.api.espn.com/apis/site/v2/sports/basketball/mens-college-basketball/teams?limit=400');
                    
                    if (!response.ok) {
                        throw new Error('Failed to fetch from ESPN');
                    }
                    
                    const data = await response.json();
                    
                    // Parse ESPN data
                    const records = {};
                    const sports = data.sports || [];
                    
                    if (sports.length > 0) {
                        const leagues = sports[0].leagues || [];
                        if (leagues.length > 0) {
                            const teams = leagues[0].teams || [];
                            
                            teams.forEach(teamObj => {
                                const team = teamObj.team || {};
                                const teamName = team.displayName || '';
                                const record = team.record || {};
                                const items = record.items || [];
                                
                                let wins = 0;
                                let losses = 0;
                                
                                // Find overall record
                                for (const item of items) {
                                    if (item.type === 'total') {
                                        const stats = item.stats || [];
                                        for (const stat of stats) {
                                            if (stat.name === 'wins') {
                                                wins = parseInt(stat.value) || 0;
                                            } else if (stat.name === 'losses') {
                                                losses = parseInt(stat.value) || 0;
                                            }
                                        }
                                    }
                                }
                                
                                if (teamName) {
                                    records[teamName] = {
                                        wins: wins,
                                        losses: losses,
                                        games: wins + losses
                                    };
                                }
                            });
                        }
                    }
                    
                    // Match our teams to ESPN teams
                    const matchedRecords = {};
                    const allOurTeams = new Set();
                    Object.values(DRAFT_DATA).forEach(teams => {
                        teams.forEach(team => allOurTeams.add(team));
                    });
                    
                    let matchedCount = 0;
                    let notFound = [];
                    
                    allOurTeams.forEach(ourTeam => {
                        // Try exact match
                        if (records[ourTeam]) {
                            matchedRecords[ourTeam] = records[ourTeam];
                            matchedCount++;
                        } else {
                            // Try normalized match
                            const normalized = normalizeTeamName(ourTeam);
                            let found = false;
                            
                            for (const [espnName, espnRecord] of Object.entries(records)) {
                                if (normalizeTeamName(espnName).toLowerCase() === normalized.toLowerCase()) {
                                    matchedRecords[ourTeam] = espnRecord;
                                    matchedCount++;
                                    found = true;
                                    break;
                                }
                            }
                            
                            if (!found) {
                                matchedRecords[ourTeam] = { wins: 0, losses: 0, games: 0 };
                                notFound.push(ourTeam);
                            }
                        }
                    });
                    
                    setTeamRecords(matchedRecords);
                    setLastUpdate(new Date().toLocaleString());
                    
                    if (notFound.length > 0) {
                        setFetchStatus(`‚úì Updated ${matchedCount} teams | ‚ö† ${notFound.length} teams not found`);
                    } else {
                        setFetchStatus(`‚úì Updated ${matchedCount} teams from ESPN!`);
                    }
                    
                } catch (error) {
                    console.error('Fetch error:', error);
                    setFetchStatus('‚ö†Ô∏è Failed to fetch from ESPN. Try again or check console for errors.');
                } finally {
                    setFetching(false);
                }
            };

            const calculateParticipantStats = (participant) => {
                const teams = DRAFT_DATA[participant] || [];
                let totalWins = 0;
                let totalGames = 0;
                
                const teamStats = teams.map(teamName => {
                    const record = teamRecords[teamName] || { wins: 0, losses: 0, games: 0 };
                    totalWins += record.wins;
                    totalGames += record.games;
                    return {
                        name: teamName,
                        ...record
                    };
                });
                
                return {
                    totalWins,
                    totalGames,
                    teams: teamStats.sort((a, b) => b.wins - a.wins)
                };
            };

            const leaderboard = useMemo(() => {
                return Object.keys(DRAFT_DATA).map(participant => {
                    const stats = calculateParticipantStats(participant);
                    return {
                        name: participant,
                        ...stats
                    };
                }).sort((a, b) => b.totalWins - a.totalWins);
            }, [teamRecords]);

            if (Object.keys(teamRecords).length === 0 && !fetching) {
                return (
                    <div className="flex items-center justify-center min-h-screen">
                        <div className="text-center">
                            <div className="text-6xl mb-4">üèÄ</div>
                            <div className="text-xl text-gray-600 mb-4">Ready to load live ESPN data!</div>
                            <button
                                onClick={fetchESPNData}
                                className="bg-green-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-green-600 transition shadow-lg"
                            >
                                üîÑ Refresh from ESPN
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen pb-12">
                    {/* Header */}
                    <div className="gradient-bg text-white shadow-2xl">
                        <div className="container mx-auto px-4 py-5">
                            <div className="text-center">
                                <h1 className="text-4xl font-black mb-1">üèÄ NCAA Basketball Pool</h1>
                                <p className="text-xl opacity-90">2025-26 Season - Live ESPN Data</p>
                                {lastUpdate && (
                                    <p className="text-sm opacity-75 mt-2">Last Updated: {lastUpdate}</p>
                                )}
                                {fetchStatus && (
                                    <p className="text-sm opacity-90 mt-1">{fetchStatus}</p>
                                )}
                            </div>
                            
                            <div className="mt-6 flex justify-center gap-4 flex-wrap">
                                <button
                                    onClick={fetchESPNData}
                                    disabled={fetching}
                                    className={`bg-green-500 text-white px-6 py-2 rounded-lg font-semibold hover:bg-green-600 transition shadow-lg flex items-center gap-2 ${fetching ? 'opacity-50 cursor-not-allowed' : ''}`}
                                >
                                    {fetching ? (
                                        <>
                                            <span className="animate-spin">‚ü≥</span>
                                            Fetching...
                                        </>
                                    ) : (
                                        <>
                                            üîÑ Refresh from ESPN
                                        </>
                                    )}
                                </button>
                                <button
                                    onClick={() => setAutoRefresh(!autoRefresh)}
                                    className={`${autoRefresh ? 'bg-green-500' : 'bg-white/20 backdrop-blur'} text-white px-6 py-2 rounded-lg font-semibold hover:bg-green-600 transition`}
                                >
                                    {autoRefresh ? '‚úì Auto-Refresh ON (5 min)' : '‚è∏ Auto-Refresh OFF'}
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Leaderboard */}
                    <div className="container mx-auto px-4 py-8">
                        <div className="bg-white rounded-xl shadow-xl p-4 mb-6">
                            <h2 className="text-2xl font-bold mb-4 text-center bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
                                üèÜ Leaderboard
                            </h2>
                            
                            <div className="grid gap-2">
                                {leaderboard.map((participant, index) => {
                                    const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : '';
                                    const bgClass = index === 0 ? 'bg-yellow-50' : index === 1 ? 'bg-gray-50' : index === 2 ? 'bg-orange-50' : 'bg-white';
                                    
                                    return (
                                        <div
                                            key={participant.name}
                                            className={`${rankClass} ${bgClass} rounded-lg p-2 shadow-sm hover:shadow-md transition cursor-pointer`}
                                            onClick={() => setSelectedParticipant(participant.name)}
                                        >
                                            <div className="flex items-center justify-between">
                                                <div className="flex items-center gap-3">
                                                    <div className={`w-9 h-9 rounded-full flex items-center justify-center font-black text-sm ${
                                                        index === 0 ? 'trophy-gold text-white' :
                                                        index === 1 ? 'trophy-silver text-white' :
                                                        index === 2 ? 'trophy-bronze text-white' :
                                                        'bg-gray-200 text-gray-700'
                                                    }`}>
                                                        {index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : index + 1}
                                                    </div>
                                                    <div>
                                                        <h3 className="text-base font-bold text-gray-800">{participant.name}</h3>
                                                        <p className="text-xs text-gray-500">
                                                            {participant.teams.length} teams ‚Ä¢ {participant.totalGames} games
                                                        </p>
                                                    </div>
                                                </div>
                                                <div className="text-right">
                                                    <div className="text-2xl font-black bg-gradient-to-r from-green-600 to-green-500 bg-clip-text text-transparent">
                                                        {participant.totalWins}
                                                    </div>
                                                    <div className="text-xs text-gray-500 font-semibold">WINS</div>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Participant Details */}
                        {selectedParticipant && (
                            <div className="bg-white rounded-2xl shadow-xl p-6 mb-8 animate-fade-in">
                                <div className="flex justify-between items-center mb-6">
                                    <h2 className="text-3xl font-bold text-gray-800">
                                        {selectedParticipant}'s Roster
                                    </h2>
                                    <button
                                        onClick={() => setSelectedParticipant(null)}
                                        className="text-gray-500 hover:text-gray-700 text-2xl"
                                    >
                                        ‚úï
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {calculateParticipantStats(selectedParticipant).teams.map((team, index) => (
                                        <div
                                            key={index}
                                            className="card-hover bg-gradient-to-br from-white to-gray-50 rounded-xl p-4 shadow-md border border-gray-200"
                                        >
                                            <div className="flex items-center gap-3 mb-3">
                                                <img
                                                    src={getTeamLogo(team.name)}
                                                    alt={team.name}
                                                    className="team-logo"
                                                    onError={(e) => {
                                                        e.target.src = `https://via.placeholder.com/32x32/667eea/ffffff?text=${team.name.charAt(0)}`;
                                                    }}
                                                />
                                                <div className="flex-1">
                                                    <h4 className="font-bold text-gray-800 text-sm">{team.name}</h4>
                                                    <p className="text-xs text-gray-500">
                                                        {team.wins}-{team.losses} ({team.games} games)
                                                    </p>
                                                </div>
                                            </div>
                                            
                                            <div className="win-badge text-white px-3 py-1 rounded-lg text-center font-bold text-sm">
                                                {team.wins} WINS
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Quick Stats Grid */}
                        <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                            <div className="stat-card rounded-xl p-4 shadow-lg text-center">
                                <div className="text-3xl mb-2">üë•</div>
                                <div className="text-2xl font-bold text-gray-800">{Object.keys(DRAFT_DATA).length}</div>
                                <div className="text-sm text-gray-500">Participants</div>
                            </div>
                            <div className="stat-card rounded-xl p-4 shadow-lg text-center">
                                <div className="text-3xl mb-2">üèÄ</div>
                                <div className="text-2xl font-bold text-gray-800">140</div>
                                <div className="text-sm text-gray-500">Total Teams</div>
                            </div>
                            <div className="stat-card rounded-xl p-4 shadow-lg text-center">
                                <div className="text-3xl mb-2">üéØ</div>
                                <div className="text-2xl font-bold text-gray-800">
                                    {Object.values(teamRecords).reduce((sum, r) => sum + r.wins, 0)}
                                </div>
                                <div className="text-sm text-gray-500">Total Wins</div>
                            </div>
                            <div className="stat-card rounded-xl p-4 shadow-lg text-center">
                                <div className="text-3xl mb-2">üìä</div>
                                <div className="text-2xl font-bold text-gray-800">
                                    {Object.values(teamRecords).reduce((sum, r) => sum + r.games, 0)}
                                </div>
                                <div className="text-sm text-gray-500">Games Played</div>
                            </div>
                            <div className="stat-card rounded-xl p-4 shadow-lg text-center">
                                <div className="text-3xl mb-2">üî•</div>
                                <div className="text-2xl font-bold text-gray-800">
                                    {leaderboard.length > 0 ? leaderboard[0].totalWins : 0}
                                </div>
                                <div className="text-sm text-gray-500">Leading Score</div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('app'));
        root.render(<PoolTracker />);
    </script>
</body>
</html>